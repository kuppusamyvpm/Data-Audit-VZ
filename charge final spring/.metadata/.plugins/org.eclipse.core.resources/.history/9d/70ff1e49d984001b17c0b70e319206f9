package com.charge.demo.repository;

import java.util.List;

import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.data.jpa.repository.JpaRepository;

import com.charge.demo.model.charge;

public interface chargeRepo extends JpaRepository<charge, String> 
{

//	List<charge> findAll();
	String compared_charge="select from sv where account_name='abd17'";
   
	@Query(nativeQuery = true,value = compared_charge)
    List<charge> getcharge2();

    
//    @Query("select ACCOUNT_NAME from comp_charge WHERE ACCOUNT_NAME= :acc_no")
//    charge findUserByStatusAndNameNamedParams(
//      @Param("acc_no") String acc_no); 
    
    @Query(value = "select * from ccabs_charge;\r\n"
    		+ "With ccabs as (\r\n"
    		+ "select\r\n"
    		+ "BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC, LATA, CIC,sum(Charge) CHARGE\r\n"
    		+ "from\r\n"
    		+ "ccabs_charge\r\n"
    		+ "where\r\n"
    		+ "record_type_id=2\r\n"
    		+ "and\r\n"
    		+ "billing_period=:bil_period\r\n"
    		+ "and\r\n"
    		+ "account_name=:acc_no\r\n"
    		+ "group by BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC, LATA, CIC),\r\n"
    		+ "sv as(\r\n"
    		+ "select\r\n"
    		+ "BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC, LATA, CIC,sum(CHARGE) CHARGE\r\n"
    		+ "from\r\n"
    		+ "sv_charge\r\n"
    		+ "where\r\n"
    		+ "record_type_id=2\r\n"
    		+ "and\r\n"
    		+ "billing_period=:bil_period\r\n"
    		+ "and\r\n"
    		+ "account_name=:acc_no\r\n"
    		+ "group by BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC, LATA, CIC)\r\n"
    		+ "select\r\n"
    		+ "ccabs.BILLING_PERIOD,SV.CUSTOMER_NAME,ccabs.ACCOUNT_NAME,ccabs.BILL_TYPE,ccabs.MARKET_ID,ccabs.WC_ICC,ccabs.LATA,ccabs.CIC,\r\n"
    		+ "ccabs.charge ccabs_charge,\r\n"
    		+ "sv.charge sv_charge,(sv.charge-ccabs.charge) diff_charge\r\n"
    		+ "from ccabs,sv\r\n"
    		+ "where\r\n"
    		+ "ccabs.account_Name=sv.account_name(+)\r\n"
    		+ "and\r\n"
    		+ "ccabs.wc_icc=sv.wc_icc\r\n"
    		+ "and\r\n"
    		+ "ccabs.lata=sv.lata;", nativeQuery = true)
    String findByKeyword(@Param("acc_no") String acc_no ,@Param("bil_period") String bil_period);
//    ,@Param("bil_type") String  bil_type
//    || BILL_TYPE=:bil_type
//    select BILLING_PERIOD from COMP_CHARGE where ACCOUNT_NAME=:acc_no 
}
