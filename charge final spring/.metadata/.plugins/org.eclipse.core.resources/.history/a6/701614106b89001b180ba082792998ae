package com.charge.demo.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;

import com.charge.demo.model.overallprojection;

public interface overallprojectionRepo extends JpaRepository<overallprojection,List<String>> 
{
	  String ab="SELECT \r\n"
	  		+ "NVL(CABS.BILLING_PERIOD,SV.BILLING_PERIOD) BILLING_PERIOD,\r\n"
	  		+ "NVL(CABS.BILL_TYPE,SV.BILL_TYPE) BILL_TYPE,\r\n"
	  		+ "CABS.CHARGE CCABS_CHARGE,\r\n"
	  		+ "SV.CHARGE SV_CHARGE,\r\n"
	  		+ "(SV.CHARGE-CABS.CHARGE) DIFF_CHARGE,\r\n"
	  		+ "CABS.USAGE CCABS_USAGE,\r\n"
	  		+ "SV.USAGE SV_USAGE,\r\n"
	  		+ "(SV.USAGE-CABS.USAGE) DIFF_USAGE,\r\n"
	  		+ "CABS.VOLUME CCABS_VOLUME,\r\n"
	  		+ "SV.VOLUME SV_VOLUME,\r\n"
	  		+ "(SV.VOLUME-CABS.VOLUME) DIFF_VOLUME \r\n"
	  		+ "FROM \r\n"
	  		+ "(SELECT BILLING_PERIOD,BILL_TYPE,SUM(CHARGE) CHARGE,SUM(USAGE) USAGE,SUM(VOLUME) VOLUME\r\n"
	  		+ "FROM \r\n"
	  		+ "CCABS_CHARGE \r\n"
	  		+ "WHERE RECORD_TYPE_ID=2 \r\n"
	  		+ "GROUP BY  BILLING_PERIOD,BILL_TYPE) CABS  FULL JOIN\r\n"
	  		+ "(SELECT BILLING_PERIOD,BILL_TYPE,SUM(CHARGE) CHARGE,SUM(USAGE) USAGE,SUM(VOLUME) VOLUME\r\n"
	  		+ "FROM \r\n"
	  		+ "SV_CHARGE \r\n"
	  		+ "WHERE RECORD_TYPE_ID=2 \r\n"
	  		+ "GROUP BY BILLING_PERIOD,BILL_TYPE) SV\r\n"
	  		+ "ON (CABS.BILL_TYPE=SV.BILL_TYPE)\r\n"
	  		+ "WHERE\r\n"
	  		+ "CABS.BILLING_PERIOD=SV.BILLING_PERIOD\r\n"
	  		+ "UNION\r\n"
	  		+ "SELECT \r\n"
	  		+ "NVL(CABS.BILLING_PERIOD,SV.BILLING_PERIOD) BILLING_PERIOD,\r\n"
	  		+ "'SUMMARY' BILL_TYPE,\r\n"
	  		+ "CABS.CHARGE CABS_CHARGE,\r\n"
	  		+ "SV.CHARGE SV_CHARGE,\r\n"
	  		+ "(SV.CHARGE-CABS.CHARGE) DIFF_CHARGE,\r\n"
	  		+ "CABS.USAGE CABS_USAGE,\r\n"
	  		+ "SV.USAGE SV_USAGE,\r\n"
	  		+ "(SV.USAGE-CABS.USAGE) DIFF_USAGE,\r\n"
	  		+ "CABS.VOLUME CABS_VOLUME,\r\n"
	  		+ "SV.VOLUME SV_VOLUME,\r\n"
	  		+ "(SV.VOLUME-CABS.VOLUME) DIFF_VOLUME \r\n"
	  		+ "FROM \r\n"
	  		+ "(SELECT BILLING_PERIOD,SUM(CHARGE) CHARGE,SUM(USAGE) USAGE,SUM(VOLUME) VOLUME\r\n"
	  		+ "FROM \r\n"
	  		+ "CCABS_CHARGE \r\n"
	  		+ "WHERE RECORD_TYPE_ID=2 \r\n"
	  		+ "GROUP BY  BILLING_PERIOD) CABS  FULL JOIN\r\n"
	  		+ "(SELECT BILLING_PERIOD,SUM(CHARGE) CHARGE,SUM(USAGE) USAGE,SUM(VOLUME) VOLUME\r\n"
	  		+ "FROM \r\n"
	  		+ "SV_CHARGE \r\n"
	  		+ "WHERE RECORD_TYPE_ID=2 \r\n"
	  		+ "GROUP BY BILLING_PERIOD) SV\r\n"
	  		+ "ON (CABS.BILLING_PERIOD=SV.BILLING_PERIOD)\r\n"
	  		+ "ORDER BY 2";
	    @Query(nativeQuery = true,value = ab)  List<String> getcharge3();

}
