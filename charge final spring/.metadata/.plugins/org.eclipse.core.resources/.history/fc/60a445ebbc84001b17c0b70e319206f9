package com.charge.demo.repository;

import java.util.List;

import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.data.jpa.repository.JpaRepository;

import com.charge.demo.model.charge;

public interface chargeRepo extends JpaRepository<charge, String> 
{

//	List<charge> findAll();
	String compared_charge="select from sv where account_name='abd17'";
   
	@Query(nativeQuery = true,value = compared_charge)
    List<charge> getcharge2();

    
//    @Query("select ACCOUNT_NAME from comp_charge WHERE ACCOUNT_NAME= :acc_no")
//    charge findUserByStatusAndNameNamedParams(
//      @Param("acc_no") String acc_no); 
    
  
    
    @Query(value = "\r\n"
    		+ "With cabs as (\r\n"
    		+ "select\r\n"
    		+ "BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC, LATA, CIC,sum(USAGE_CHARGE) CHARGE\r\n"
    		+ "from\r\n"
    		+ "cabs_charge\r\n"
    		+ "where\r\n"
    		+ "record_type_id=1\r\n"
    		+ "and\r\n"
    		+ "billing_period=:bil_per\r\n"
    		+ "and\r\n"
    		+ "account_name=:acc_no\r\n"
    		+ "group by BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC, LATA, CIC),\r\n"
    		+ "sv as(\r\n"
    		+ "select\r\n"
    		+ "BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC, LATA, CIC,sum(USAGE_CHARGE) CHARGE\r\n"
    		+ "from\r\n"
    		+ "sv_charge\r\n"
    		+ "where\r\n"
    		+ "record_type_id=1\r\n"
    		+ "and\r\n"
    		+ "billing_period=:bil_per\r\n"
    		+ "and\r\n"
    		+ "account_name=:acc_no\r\n"
    		+ "group by BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC, LATA, CIC)\r\n"
    		+ "select\r\n"
    		+ "cabs.BILLING_PERIOD,SV.CUSTOMER_NAME,cabs.ACCOUNT_NAME,cabs.BILL_TYPE,cabs.MARKET_ID,cabs.WC_ICC,cabs.LATA,cabs.CIC,\r\n"
    		+ "cabs.charge cabs_charge,\r\n"
    		+ "sv.charge sv_charge,(sv.charge-cabs.charge) diff_charge\r\n"
    		+ "from cabs,sv\r\n"
    		+ "where\r\n"
    		+ "cabs.account_Name=sv.account_name(+)\r\n"
    		+ "and\r\n"
    		+ "cabs.wc_icc=sv.wc_icc\r\n"
    		+ "and\r\n"
    		+ "cabs.lata=sv.lata;", nativeQuery = true)
    String findByKeyword(@Param("acc_no") String acc_no ,@Param("bil_type") String bil_type ,@Param("bil_per") int bil_per );
//    ,@Param("bil_type") String  bil_type
//    || BILL_TYPE=:bil_type
//   select BILLING_PERIOD from COMP_CHARGE where ACCOUNT_NAME=:acc_no
}
