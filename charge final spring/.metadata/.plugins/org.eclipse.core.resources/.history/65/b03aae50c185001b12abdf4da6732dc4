package com.charge.demo.repository;

import java.util.List;
import java.util.Map;

import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.boot.autoconfigure.integration.IntegrationProperties.Jdbc;
import org.springframework.data.jpa.repository.JpaRepository;

import com.charge.demo.model.ccabs_charge;
import com.charge.demo.model.charge;

public interface chargeRepo extends JpaRepository<charge, List<String>> 
{
//	ccabs_charge cc = new ccabs_charge();
	
    @Query(value ="\r\n"
    		+ "\r\n"
    		+ "select\r\n"
    		+ "ccabs.ACCOUNT_NAME,ccabs.MARKET_ID,ccabs.WC_ICC,ccabs.STATE,ccabs.LATA,ccabs.CIC,\r\n"
    		+ "ccabs.charge ccabs_charge,\r\n"
    		+ "sv.charge sv_charge,(sv.charge-ccabs.charge) diff_charge\r\n"
    		+ "from (\r\n"
    		+ "select\r\n"
    		+ "BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC,STATE, LATA, CIC,sum(Charge) CHARGE\r\n"
    		+ "from\r\n"
    		+ "ccabs_charge\r\n"
    		+ "where\r\n"
    		+ "record_type_id=2\r\n"
    		+ "and\r\n"
    		+ "billing_period=:billtype\r\n"
    		+ "and\r\n"
    		+ "account_name=:acc_no\r\n"
    		+ "group by BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC,STATE, LATA, CIC) ccabs,\r\n"
    		+ "(\r\n"
    		+ "select\r\n"
    		+ "BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC,STATE, LATA, CIC,sum(CHARGE) CHARGE\r\n"
    		+ "from\r\n"
    		+ "sv_charge\r\n"
    		+ "where\r\n"
    		+ "record_type_id=2\r\n"
    		+ "and\r\n"
    		+ "billing_period=:billtype\r\n"
    		+ "and\r\n"
    		+ "account_name=:acc_no\r\n"
    		+ "group by BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,\r\n"
    		+ "WC_ICC,STATE, LATA, CIC) sv\r\n"
    		+ "\r\n"
    		+ "where\r\n"
    		+ "ccabs.account_Name=sv.account_name(+)\r\n"
    		+ "and\r\n"
    		+ "ccabs.wc_icc=sv.wc_icc(+)\r\n"
    		+ "and\r\n"
    		+ "ccabs.state=sv.state(+)\r\n"
    		+ "and\r\n"
    		+ "ccabs.lata=sv.lata(+)", nativeQuery = true)
   
    List<String> findByKeyword(@Param("acc_no") String acc_no,@Param("billtype") String billtype);
   
    
    
}
