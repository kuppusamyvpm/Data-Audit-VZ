package com.charge.demo.controller;

import java.io.Console;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.json.JSONArray;
import org.json.JSONObject;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import com.charge.demo.model.charge;
import com.charge.demo.repository.chargeRepo;
//import com.charge.demo.repository.map;
import com.charge.demo.service.chargeService;
import com.google.gson.JsonObject;

@RestController
@CrossOrigin("*")
public class chargeController 
{
	@Autowired
	private chargeRepo cr;
	
	@Autowired
	private chargeService cs;
	
	//level1
	
	@RequestMapping("/ccabs/{acc_no}/{billtype}")
	 String method(@PathVariable String acc_no,@PathVariable String billtype) 
	{

		List<String> c=cr.findByKeyword(acc_no,billtype);
		JsonObject charge = new JsonObject();
		List<String> b=new ArrayList<>();
		
		for(int i=0;i<c.size();i++)
		{
			
			
			System.out.println(c.get(i));
			String[] a=c.get(i).split(",");
			charge.addProperty("accountnbr", a[0]);
			charge.addProperty("market_id", a[1]);
			charge.addProperty("wc_icc", a[2]);
			charge.addProperty("state", a[3]);
			charge.addProperty("lata", a[4]);
			charge.addProperty("cic", a[5]);
			charge.addProperty("ccabs_charge", a[6]);
			charge.addProperty("sv_charge", a[7]);
			charge.addProperty("differ_charge", a[8]);
			System.out.println(charge.toString());
			b.add(charge.toString());
			
			
		}
		System.out.println(b);
		
		return b.toString();
	}
	
//	accountnbr,market_id,wc_icc,state,lata,
//    cic,ccabs_charge,sv_charge,differ_charge
	///level2
	@RequestMapping("/ccabs/{acc_no}/{billtype}")
	 String method1(@PathVariable String accountnbr,@PathVariable String market_id,
			 @PathVariable String wc_icc,@PathVariable String lata,
			 @PathVariable String ccabs_charge,@PathVariable String sv_charge,
			 @PathVariable String differ_charge) 
	{

//		List<String> c=cr.findByLevel2(accountnbr,market_id,wc_icc,lata,ccabs_charge,sv_charge,differ_charge);
//		JsonObject charge = new JsonObject();
//		List<String> b=new ArrayList<>();
//		
//		for(int i=0;i<c.size();i++)
//		{
//			
//			
//			System.out.println(c.get(i));
//			String[] a=c.get(i).split(",");
//			charge.addProperty("accountnbr", a[0]);
//			charge.addProperty("market_id", a[1]);
//			charge.addProperty("wc_icc", a[2]);
//			charge.addProperty("state", a[3]);
//			charge.addProperty("lata", a[4]);
//			charge.addProperty("cic", a[5]);
//			charge.addProperty("ccabs_charge", a[6]);
//			charge.addProperty("sv_charge", a[7]);
//			charge.addProperty("differ_charge", a[8]);
//			System.out.println(charge.toString());
//			b.add(charge.toString());
//			
//			
//		}
//		System.out.println(b);
//		
//		return b.toString();
//	}
//	
//	
	
	
	
	
	@GetMapping("/ccabs")
    @CrossOrigin(origins="http://localhost:4200")
	public List<charge>fetchbyuserList() 
	{
	 List<charge> a=new ArrayList<charge>();
	 a=cs.fetchbyuserList();
	 return a;
	}
	
	
	
//	public charge table1call(@RequestBody charge user) throws Exception {
//	       
//        String tempaccname=user.getACCOUNT_NAME();
//        int tempbillperiod=user.getBILLING_PERIOD();
//        charge userobj= cs.fetchUserByAccountAndBill(tempaccname,tempbillperiod);
//        return userobj;
//        }
	
  
  
  
}
