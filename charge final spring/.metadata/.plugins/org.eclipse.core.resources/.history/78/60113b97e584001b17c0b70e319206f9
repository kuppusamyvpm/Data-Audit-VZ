package com.charge.demo.repository;

import java.util.List;

import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.data.jpa.repository.JpaRepository;

import com.charge.demo.model.charge;

public interface chargeRepo extends JpaRepository<charge, String> 
{

//	List<charge> findAll();
	String compared_charge="select from sv where account_name='abd17'";
   
	@Query(nativeQuery = true,value = compared_charge)
    List<charge> getcharge2();

    
//    @Query("select ACCOUNT_NAME from comp_charge WHERE ACCOUNT_NAME= :acc_no")
//    charge findUserByStatusAndNameNamedParams(
//      @Param("acc_no") String acc_no); 
    
    @Query(value = "With ccabs as ("
    		+ "select"
    		+ "BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,"
    		+ "WC_ICC, LATA, CIC,sum(Charge) CHARGE"
    		+ "from"
    		+ "ccabs_charge"
    		+ "where"
    		+ "record_type_id=2"
    		+ "and"
    		+ "billing_period=202103"
    		+ "and"
    		+ "account_name='ADZ3586125'"
    		+ "group by BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,"
    		+ "WC_ICC, LATA, CIC),"
    		+ "sv as("
    		+ "select"
    		+ "BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,"
    		+ "WC_ICC, LATA, CIC,sum(CHARGE) CHARGE"
    		+ "from"
    		+ "sv_charge"
    		+ "where"
    		+ "record_type_id=2"
    		+ "and"
    		+ "billing_period=202103"
    		+ "and"
    		+ "account_name='ADZ3586125'"
    		+ "group by BILLING_PERIOD,CUSTOMER_NAME, ACCOUNT_NAME, BILL_TYPE, MARKET_ID,"
    		+ "WC_ICC, LATA, CIC)"
    		+ "select"
    		+ "ccabs.BILLING_PERIOD,SV.CUSTOMER_NAME,ccabs.ACCOUNT_NAME,ccabs.BILL_TYPE,ccabs.MARKET_ID,ccabs.WC_ICC,ccabs.LATA,ccabs.CIC,"
    		+ "ccabs.charge ccabs_charge,"
    		+ "sv.charge sv_charge,(sv.charge-ccabs.charge) diff_charge"
    		+ "from ccabs,sv"
    		+ "where"
    		+ "ccabs.account_Name=sv.account_name(+)"
    		+ "and"
    		+ "ccabs.wc_icc=sv.wc_icc"
    		+ "and"
    		+ "ccabs.lata=sv.lata", nativeQuery = false)
    String findByKeyword(@Param("acc_no") String acc_no,@Param("billtype") String billtype);
    
//    ,@Param("bil_type") String  bil_type
//    || BILL_TYPE=:bil_type
//    select BILLING_PERIOD from COMP_CHARGE where ACCOUNT_NAME=:acc_no 
}
